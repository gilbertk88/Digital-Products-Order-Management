<style type="text/css">
	.ewm_dpm_single_product_selected_ano{
		border: 3px solid #11c22df0;
	}
	.ewm_dpm_ano_menu{
		width: 100%;
		overflow:auto;
		padding-bottom:20px;
		padding-left: 10px;
	}
	.ewm_dpm_ano_single_menu{
		width:48%;
		padding:5px;
		float:left;
		background:#50575e;
		color:#fff;
		cursor:pointer;
		margin-right:1%;
		border-radius:60px;
	}
	.ewm_dpm_topheading{
		width:100%;
		overflow:auto;
	}

	.ewm_dpm_parent_no_wrapper_single_stage2{
		border: 0px solid #ccc;
		padding: 20px;
		margin:30px 30px 0px 0px;
		background-color: #fff;
		border-radius: 4px;
		box-shadow: 0 5px 8px 0 rgb(151 151 151 / 10%), 0 6px 10px 0 rgb(118 118 118 / 10%) !important;
		overflow:auto;
	}
	.ewm_dpm_top_no_header_single_stage2{
		padding: 0px;
		font-size:18px;
		font-weight:bold;
	}
	.ewm_dpm_main_no_content_single_stage2{}
	.ewm_dpm_no_table_list_single_stage2{
		margin-bottom:40px;
		margin-top:20px;
	}
	.ewm_dpm_single_cell_no_header_single_stage2{
		padding: 10px 25px;
		background-color: #13b184f2;
		border-radius: 4px;
		color: #ffff;
	}
	.ewm_dpm_single_cell_no_body_single_stage2{
		padding: 10px 10px 2px 15px;
		background-color:#fff;
		min-width:180px;
	}
	.ewm_dpm_single_cell_no_body_single_value_stage2{
		padding: 5px;
		font-weight:bold;
		min-width:500px;
		border:0px solid #74af9a24;
	}
	.ewm_dpm_view_manage_no_button_single_stage2{
		background-color:#13b97d;
		padding: 5px 50px;
		color:white;
		border: 0px;
		cursor: pointer;
		border-radius:4px;
	}
	.ewm_dpm_new_single_no_button_single_stage2{
		background-color:white;
		padding: 5px 50px;
		font-size: 15px;
		color:white;
		border: 1px #33333340 solid;
		color:#333;
		cursor: pointer;
		border-radius:4px;
		float:right;
		margin:30px 5px;
	}
	.ewm_dpm_top_menu_area_no_single_stage2{
		width: 90%;
		overflow: auto !important;
		padding: 20px 50px;

	}
	.ewm_dpm_single_cell_no_description_single_stage2{
		font-size:10px;
	}
	.ewm_button_no_stage2{
		float:right;			
		background-color: #007e55 !important;
		padding: 5px 50px;
		font-size: 15px;
		color: white;
		border: 0px;
		cursor: pointer;
		border-radius: 5px;
		float: right;
		box-shadow: 0 5px 8px 0 rgb(97 97 97 / 50%), 0 6px 10px 0 rgb(118 118 118 / 10%) !important;
	}
	.ewm_button_no_stage2{
		float:right;
		background-color: #007e55 !important;
		padding: 5px 50px;
		font-size: 15px;
		color: white;
		border: 0px;
		cursor: pointer;
		border-radius: 5px;
		float: right;
		box-shadow: 0 5px 8px 0 rgb(97 97 97 / 50%), 0 6px 10px 0 rgb(118 118 118 / 10%) !important;
	}
	#ewm_dpm_submit_new_order_stage2{
		background-color: #2ea7d3 !important;
		padding: 10px 30px;
		font-size: 15px;
		font-weight: 400;
		color: white;
		border: 0px;
		cursor: pointer;
		border-radius: 15px;
		box-shadow: 0 5px 8px 0 rgb(97 97 97 / 50%), 0 6px 10px 0 rgb(118 118 118 / 10%) !important;
	}
	.ewm_dpm_single_input_f_stage2{
		width: 100%;
		border: 1px solid #80808066;
		border-radius: 50px;
		padding: 8px 20px;
	}
	#_order_stage_stage2{
		width: 100%;
		font-weight: 380;
	}
	.ewmdpm_main_stage_stage2{
		width: 100%;
		overflow: auto;
		padding:10px;
	}
	.ewm_dpm_form_f{
		padding: 30px 30px 60px 30px;
		border: solid var(--wc-secondary) 1px;
		margin: 20px;
		border-radius: 4px;
	}
	.ewmdpm_order_creation_stage_stage2{
		width:12%;
		margin-right:1%;
		font-size: 14px;
		font-weight:300;
		color: #222;
		box-shadow: 0 5px 8px 0 rgb(151 151 151 / 10%), 0 6px 10px 0 rgb(118 118 118 / 10%) !important;
		border-radius: 5px;
		float:left;
		border:1px solid #cccccc38;
		padding:5px;
		cursor:pointer;
	}
	.ewmdpm_order_creation_stage_active_stage2{
		background-color: #333;
		color:#fff;
	}
	.top__billing_first_name, .top__billing_last_name, .top__billing_company, .top__billing_address_1 , .top__billing_address_2, .top__billing_city, .top__billing_state, .top__billing_state, .top__billing_state, .top__billing_postcode, .top__billing_postcode, .top__billing_country, .top__billing_email, .top__billing_phone, .top__cart_discount, .top__cart_discount_tax, .top__order_tax, .top__order_total, .top__prices_include_tax, .top__order_total, .top__prices_include_tax {
		width: 50%;
		float: left;
	}
	.ewm_dpm_client_dropdown_sec{
		width:100%;
	}
	.ewm_dpm_client_dropdown_input{
		border-radius: 10px !important;
    	padding: 5px 15px !important;
	}
</style>
	<input type="hidden" class="" id="ewm_dpm_cache_post" value="" >
	<div class="ewm_dpm_no_table_list_single_stage2">
		<div class="ewm_dpm_topheading_stage2">
			<h3><center>Client Details</center></h3>
		</div>
		<div class="ewm_dpm_client_dropdown_sec">
			<center>
			<?php
				// $user_id = $_GET['single_order_id'];
				/*
				$ord_data_details = [
					'_billing_first_name'   => get_post_meta( $user_id, 'ewm_dpm_billing_first_name' , true ),
					'_billing_last_name'    => get_post_meta( $user_id, 'ewm_dpm_billing_last_name' , true ),
					'_billing_company'      => get_post_meta( $user_id, 'ewm_dpm_billing_company' , true ),
					'_billing_address_1'    => get_post_meta( $user_id, 'ewm_dpm_billing_address_1' , true ),
					'_billing_address_2'    => get_post_meta( $user_id, 'ewm_dpm_billing_address_2' , true ),
					'_billing_city'         => get_post_meta( $user_id, 'ewm_dpm_billing_city' , true ),
					'_billing_state'        => get_post_meta( $user_id, 'ewm_dpm_billing_state' , true ),
					'_billing_postcode'     => get_post_meta( $user_id, 'ewm_dpm_billing_postcode' , true ),
					'_billing_country'      => get_post_meta( $user_id, 'ewm_dpm_billing_country' , true ),
					'_billing_email'        => get_post_meta( $user_id, 'ewm_dpm_billing_email' , true ),
					'_billing_phone'        => get_post_meta( $user_id, 'ewm_dpm_billing_phone' , true ),
					'_cart_discount'        => get_post_meta( $user_id, 'ewm_dpm_cart_discount' , true ),
					'_cart_discount_tax'    => get_post_meta( $user_id, 'ewm_dpm_cart_discount_tax' , true ),
					'_order_tax'            => get_post_meta( $user_id, 'ewm_dpm_order_tax' , true ),
					'_order_total'          => get_post_meta( $user_id, 'ewm_dpm_order_total' , true ),
					'_prices_include_tax'   => get_post_meta( $user_id, 'ewm_dpm_prices_include_tax' , true ),
					'is_vat_exempt'         => get_post_meta( $user_id, 'ewm_dpm_is_vat_exempt' , true ),
					'_customer_user'        => get_post_meta( $user_id, '_customer_user' , true )
				];
				*/
				$ord_data_details = get_post_meta( $_GET['single_order_id'] );

				// get clients
				$data_list = get_users(array( 'role__in' => array( 'ewmdsm_client' ) ));
						// var_dump( $data_list );
						// echo '<br><br>';
						// $user_by_id = get_user_by( 'ID', 11 );
				$user_by_id = get_user_meta($_GET['single_order_id'], '_customer_user', true);
				if ( strlen($user_by_id) == 0) {
                        // var_dump( $user_by_id );
                        // data->ID
                        // data->user_email
                        // data->display_name
    			?>
				<select class="ewm_dpm_client_dropdown_input">
					<option value="0">Select a Client</option>
					<?php
                    // on change.
                    // replace client
                	// updated billing info
                    // get clients
                    // $data_list = get_users(array( 'role__in' => array( 'ewmdsm_client' ) ));
					foreach ($data_list  as $Ukey => $Uvalue) {
						$Uvalue_meta = get_user_meta( $Uvalue->data->ID, 'ewm_dpm_client_code', true );						
						$selected ='';
						if( $_customer_user == $Uvalue->data->ID ){
							$selected = 'selected';
						}
						echo '<option value="'.$Uvalue->data->ID.'" '.$selected.'>'.$Uvalue->data->display_name.' ( '. $Uvalue->data->user_email.' | '. $Uvalue_meta .') </option>';
					}
    				?>
				</select>
			<?php }
			else{
				// var_dump( $user_by_id );
				$Uvalue = get_user_by( 'ID', $user_by_id );

				//var_dump( $Uvalue );
				$Uvalue_meta = get_user_meta( $Uvalue->data->ID, 'ewm_dpm_client_code', true );

			}

			?>
			</center>
		</div>

		<div class="ewm_dpm_form_f">
			<?php
			$ewm_dpm_stages = [
				'wc-pending' 	=> 'Pending payment' ,
				'wc-processing' => 'Active Orders' ,
				'wc-on-hold' 	=> 'On hold' ,
				'wc-completed' 	=> 'Completed' ,
				'wc-cancelled'  => 'Cancelled' ,
				'wc-refunded' 	=> 'Refunded' ,
				'wc-failed' 	=> 'Failed' ,
			];

			// $single_no_p_meta = get_post_meta( $single_no_p->ID );
			$value_details = [];

			$single_final_no_arr = [				
				[
					'title' => 'Billing First Name',
					'value' =>  '',
					'key' 	=> '_billing_first_name'
				],
				[
					'title' => 'Billing Last Name',
					'value' => '',
					'key'	=> '_billing_last_name'
				],
				[
					'title' => 'Billing Company',
					'value' => '',
					'key' 	=> '_billing_company',
				],
				[
					'title' => 'Billing Address 1',
					'value' => '',
					'key' 	=> '_billing_address_1'
				],
				[
					'title' => 'Billing Address 2',
					'value' => '',
					'key' 	=> '_billing_address_2',
				],
				[
					'title' => 'Billing City',
					'value' => '',
					'key' 	=> '_billing_city'
				],
				[
					'title' => 'Billing State',
					'value' => '',
					'key' 	=> '_billing_state'
				],
				[
					'title' => 'Billing Postcode',
					'value' => '',
					'key' 	=> '_billing_postcode'
				],
				[
					'title' => 'Billing Country',
					'value' => '',
					'key' 	=> '_billing_country'
				],
				[
					'title' => 'Billing Email',
					'value' => '',
					'key' 	=> '_billing_email'
				],
				[
					'title' => 'Billing Phone',
					'value' => '',
					'key' 	=> '_billing_phone'
				],
				[
					'title' => 'Cart Discount',
					'value' => '',
					'key' 	=> '_cart_discount'
				],
				[
					'title' => 'Cart Discount Tax',
					'value' => '',
					'key' 	=> '_cart_discount_tax'
				],
				[
					'title' => 'Order Tax',
					'value' => '',
					'key' 	=> '_order_tax'
				],
				[
					'title' => 'Order Total',
					'value' => '',
					'key' 	=> '_order_total'
				],
				[
					'title' => 'Prices Include tax',
					'value' => '',
					'key' 	=> '_prices_include_tax'
				],
				[
					'title' => 'Vat Exempt',
					'value' => '',
					'key' 	=> 'is_vat_exempt'
				]
			];

			$post_type = 'new';
			if( array_key_exists( 'single_order_id', $_GET ) ){
				$post_type = 'old';
				foreach( $single_final_no_arr as $key_v => $value_v ){
					$value_details [ $value_v['key'] ] = get_post_meta( $_GET['single_order_id'] , $value_v['key'] , true);
				}
			}
			foreach ( $single_final_no_arr as $row => $data_no ) {
				$_inp_html = '<input value = "'.$value_details [ $data_no['key'] ].'" class="ewm_dpm_single_input_f_stage2" id="'.$data_no['key'].'" >';
				$ewm_dpm_stages = [
					'wc-pending' 	=> 'Pending payment',
					'wc-processing' => 'Active Orders',
					'wc-on-hold' 	=> 'On hold',
					'wc-completed' 	=> 'Completed',
					'wc-cancelled'  => 'Cancelled',
					'wc-refunded' 	=> 'Refunded',
					'wc-failed' 	=> 'Failed',
				];
				if( $data_no['title']  == 'Order Stage' ) {
					$_inp_html = '<select class="ewm_dpm_single_input_f_stage2" id="'.$data_no['key'].'">';
					foreach( $ewm_dpm_stages  as $k_sv => $v_sv ){
						$_inp_html .= '<option value="'.$k_sv.'">'.$v_sv.'</option>';
					}
					$_inp_html .= '</select>';
				}
				echo '
					<div class="top_'. $data_no['key'] .'">
						<div class="ewm_dpm_single_cell_no_body_single_stage2">
							'. $data_no['title'] .'
						</div>
						<div class="ewm_dpm_single_cell_no_body_single_value_stage2">
							<center>'.$_inp_html.'</center>
						</div>
					</div>';
			}
			?>
				<div>
				<br>
				<div class="ewm_dpm_single_cell_no_body_single_value_stage2">
					<center><input type="button" class="" id="ewm_dpm_submit_new_order_stage2" value="Save Client Details >>"></center>
				</div>
			</div>
		</div>
		</div>
